<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.firebase.com/js/client/2.4.2/firebase.js"></script>
    <script type="text/javascript" src="index.js"></script>
    <title>Weather Data</title>

    <style>
        .nav-link {
            color: white;
        }

        .active {
            color: cornflowerblue;
        }

        .temperaturesBtns {
            margin-top: 25px;
        }
        .btn {
            margin-bottom: 10px;
        }
        tr {
            outline: thin solid
        }

        th {
            padding-left: 30px;
            padding-right: 30px;
        }

        td {
            border: 1px solid gray;
        }

    </style>
    <script>
        let weather = [];

        function load() {
            let ref = new Firebase('https://weather-data-90123-default-rtdb.firebaseio.com/Weather/');
            let ct = 0;
            ref.on("child_added", function (data) {
                var newData = data.val();
                weather[ct] = [newData.date, parseFloat(newData.cTemp).toFixed(1), parseFloat(newData.fTemp).toFixed(1), parseFloat(newData.humidity).toFixed(1)];
                // console.log(weather);
                ct++;
            });
            chart();
        }

        function addRefresh(n) {
            document.getElementById("refresh").innerHTML = "<br><button type='button' class='btn btn-outline-danger' onclick='window.location.reload()'>Refresh Data</button>"
            chart(n)
        }

        function chart(n) {
            let oStr = "";
            let tempData = 1; //Sets if it should be Celsius (t) or Fahrenheit (f)
            oStr += "<table class='table table-striped table-hover table-sm'><tr><th>Time</th>";
            oStr += "<th>Temperature</th>";
            let symbol;
            if (n) {
                tempData = 1;
                symbol = "&degC";
                document.getElementById("bt1").style.backgroundColor = "gray";
                document.getElementById("bt2").style.backgroundColor = "black";
            } else {
                tempData = 2;
                symbol = "&degF";
                document.getElementById("bt1").style.backgroundColor = "black";
                document.getElementById("bt2").style.backgroundColor = "gray";
            }
            oStr += "<th>Humidity</th></tr>";
            for (let i = 0; i < weather.length; i++) {
                let data = weather[i];
                // console.log(data);
                oStr += `<tr><td>${data[0]}</td>`;
                oStr += `<td>${data[tempData]}${symbol}</td>`;
                oStr += `<td>${data[3]}%</td></tr>`;
            }
            oStr += "</table>";
            document.getElementById("chart").innerHTML = oStr;
        }

    </script>
</head>
<body onload="load();">
<ul class="nav justify-content-center navbar-dark bg-dark">
    <li class="nav-item">
        <a class="nav-link active" aria-current="page" href="#">Data</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="images.html">Images</a>
    </li>

</ul>

<div class="text-center">
    <button type="button" id="bt1" class="btn btn-dark temperaturesBtns" onclick="addRefresh(false)">Fahrenheit</button>
    <button type="button" id="bt2" class="btn btn-dark temperaturesBtns" onclick="addRefresh(true)">Celsius</button>
    <span id="refresh"></span>
    <div class="container">
        <div class="row">
            <div class="col-sm-3"></div>
            <div id="chart" class="col-sm-6"></div>
            <div class="col-sm-3"></div>
        </div>
    </div>
</div>

<!---->



<!---->
<footer class="bg-light text-center">
    <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        Â© 2022 Copyright - Andrew Musielak, Juan Munoz, and Stephanie Joanem
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

</body>
</html>